- name: Include all variable files
  include_vars:
    dir: 'vars' #change directory if needed
    extensions:
        - yml

- name: Gather facts about FC_r1
  oneview_storage_pool_facts:
    config: "{{ config }}"
    name: "FC_r1"

- set_fact: Vol_Stor_Pool1_uri="{{ storage_pools[0].uri }}"

- name: Gather facts about Storage pool
  oneview_storage_system_facts:
    config: "{{ config }}"
  delegate_to: localhost

- set_fact: Vol_Stor_Sys_Uri="{{ storage_systems[0].uri }}"  #REA-3PAR01

- name: Create an Enhanced Disk Template
  oneview_storage_volume_template:
    config: "{{ config }}"
    state: present
    data:
        name: 'Basic Physical Server'
        state: "Configured"
        description: "Using Ansible code to create a volume"
        provisioning:
             shareable: false
             provisionType: "Thin"
             capacity: "{{ c20Gb }}" #20Gb
             storagePoolUri: "{{ Vol_Stor_Pool1_uri }}"
        stateReason: "None"
        storageSystemUri: "{{ Stor_System_uri }}"
        snapshotPoolUri: "{{ Vol_Stor_Pool1_uri }}"
        type: StorageVolumeTemplateV3
  delegate_to: localhost
